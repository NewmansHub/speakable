!function(s,r){"use strict";var i={selector:".spkbl",insert:"before"},e={play:"Text vorlesen",pause:"Pause",progress:"Fortschritt",stop:"Schlie√üen"},n=[],o=null;function l(e,t){this.element=e,this.options=t,this._baseLanguage=this._determineLanguage(this.element),this._utterances=[],this._text=(this.element.textContent||"").trim(),this._length=this._text.length,this._progress=0,this._player=null,this._controls={},this._buildPlayer(),this._injectPlayer()}l.prototype._determineLanguage=function(e){return e.lang||(e.parentNode?this._determineLanguage(e.parentNode):null)},l.prototype._buildPlayer=function(){this._player=r.createElement("div"),this._player.className="spkbl-player spkbl-player--inactive",this._player.role="group",this._controls.play=r.createElement("button"),this._controls.play.type="button",this._controls.play.className="spkbl-ctrl spkbl-ctrl--play",this._controls.play.addEventListener("click",this.play.bind(this)),this._controls.play.appendChild(r.createTextNode(e.play)),this._player.appendChild(this._controls.play),this._controls.pause=r.createElement("button"),this._controls.pause.type="button",this._controls.pause.className="spkbl-ctrl spkbl-ctrl--pause",this._controls.pause.addEventListener("click",this.pause.bind(this)),this._controls.pause.appendChild(r.createTextNode(e.pause)),this._controls.pause.setAttribute("aria-pressed","false"),this._player.appendChild(this._controls.pause),this._controls.progress=r.createElement("progress"),this._controls.progress.className="spkbl-ctrl spkbl-ctrl--progress",this._controls.progress.max="100",this._controls.progress.value="0",this._controls.progress.setAttribute("aria-label",e.progress),this._controls.progress.setAttribute("aria-hidden","true"),this._controls.progress.setAttribute("readonly","true"),this._controls.progress.appendChild(r.createTextNode("0%")),this._player.appendChild(this._controls.progress),this._controls.stop=r.createElement("button"),this._controls.stop.type="button",this._controls.stop.className="spkbl-ctrl spkbl-ctrl--stop",this._controls.stop.addEventListener("click",this.stop.bind(this)),this._controls.stop.appendChild(r.createTextNode(e.stop)),this._player.appendChild(this._controls.stop)},l.prototype.play=function(e){this._player.classList.add("spkbl-player--active"),this._player.classList.remove("spkbl-player--inactive"),this._controls.pause.focus(),speechSynthesis.cancel(),o.text=this._text,o.onend=this.stop.bind(this),o.onboundary=this.boundary.bind(this),speechSynthesis.speak(o)},l.prototype.boundary=function(e){this._progress=Math.round(100*e.charIndex/this._length),this._controls.progress.value=this._progress,this._controls.progress.textContent=this._progress+"%",console.log(this._progress,e.name,this._text.substr(e.charIndex,e.charLength))},l.prototype.pause=function(e){speechSynthesis.speaking&&(speechSynthesis.paused?(speechSynthesis.resume(),this._player.classList.remove("spkbl-player--paused"),this._controls.pause.setAttribute("aria-pressed","false")):(speechSynthesis.pause(),this._player.classList.add("spkbl-player--paused"),this._controls.pause.setAttribute("aria-pressed","true")))},l.prototype.stop=function(e){this._player.classList.add("spkbl-player--inactive"),this._player.classList.remove("spkbl-player--active"),this._player.classList.remove("spkbl-player--paused"),this._controls.play.focus(),speechSynthesis.cancel()},l.prototype._injectPlayer=function(){if("function"!=typeof this.options.insert)switch(this.options.insert){case"before":this.element.parentNode.insertBefore(this._player,this.element);break;case"after":this.element.parentNode.insertBefore(this._player,this.element.nextSibling);break;default:this.element.insertBefore(this._player,this.element.firstChild)}else this.options.insert(this.element,this._player)},l.init=function(e){if(void 0===e&&(e={}),"SpeechSynthesisUtterance"in s){o=new SpeechSynthesisUtterance,speechSynthesis.addEventListener("voiceschanged",function(){n=speechSynthesis.getVoices(),o.voice=n.find(function(e){return!0}),o.lang="de-DE",o.volume=1,o.pitch=1,o.rate=1});var t=Object.assign(i,e),e=t.selector||"";return e.length?Array.from(r.querySelectorAll(e)).map(function(e){return new l(e,t)}):[]}return[]},"undefined"!=typeof exports?exports.Speakable=l:s.Speakable=l}("undefined"!=typeof global?global:window,document);